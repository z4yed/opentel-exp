<!DOCTYPE html>
<html lang="en">
  <%- include('partials/head.ejs') %>
  <body class="bg-gray-100 text-gray-800 min-h-screen flex flex-col">
    <%- include('partials/navigation.ejs') %>

    <main class="flex-grow container mx-auto p-6">
      <!-- Iterate Through Categorized Media -->
      <% Object.keys(categorizedMedia).forEach((category) => { %>
        <section class="mb-12">
          <h2 class="text-3xl font-bold mb-6 text-blue-500">
            <%= category %>
          </h2>
          <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">
            <% categorizedMedia[category].forEach((media) => { %>
              <!-- Video Card -->
              <div class="bg-white rounded-xl shadow-lg hover:shadow-2xl transition transform hover:-translate-y-2 overflow-hidden">
                <!-- Thumbnail -->
                <a href="/media/<%= media._id %>">
                  <img
                    src="<%= media.thumbnailUrl %>"
                    alt="<%= media.filename %>"
                    class="w-full h-48 object-cover transition-transform hover:scale-105 cursor-pointer"
                  />
                </a>
                <!-- Card Content -->
                <div class="p-4">
                  <h3 class="text-lg font-semibold text-gray-800 truncate">
                    <%= media.title %>
                  </h3>
                  <p class="text-sm text-gray-600 mb-4">
                    Uploaded by <%= media.uploadedBy.username %> on
                    <%= new Date(media.uploadedAt).toLocaleDateString() %>
                  </p>
                  <div class="flex justify-between items-center text-sm text-gray-500">
                    <span><%= media.category?.name || "Uncategorized" %></span>
                    <% if (media.published) { %>
                      <span class="bg-green-100 text-green-700 px-2 py-1 rounded-lg">
                        Published
                      </span>
                    <% } else { %>
                      <span class="bg-red-100 text-red-700 px-2 py-1 rounded-lg">
                        Unpublished
                      </span>
                    <% } %>
                  </div>
                </div>
              </div>
            <% }) %>
          </div>
        </section>
      <% }) %>

      <!-- Uncategorized Media -->
      <% if (uncategorizedMedia.length > 0) { %>
        <section class="mb-12">
          <h2 class="text-3xl font-bold mb-6 text-blue-500">
            Uncategorized Videos
          </h2>
          <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">
            <% uncategorizedMedia.forEach((media) => { %>
              <!-- Video Card -->
              <div class="bg-white rounded-xl shadow-lg hover:shadow-2xl transition transform hover:-translate-y-2 overflow-hidden">
                <!-- Thumbnail -->
                <a href="/media/<%= media._id %>/details">
                  <img
                    src="<%= media.thumbnailUrl %>"
                    alt="<%= media.filename %>"
                    class="w-full h-48 object-cover transition-transform hover:scale-105 cursor-pointer"
                  />
                </a>
                <!-- Card Content -->
                <div class="p-4">
                  <h3 class="text-lg font-semibold text-gray-800 truncate">
                    <%= media.title %>
                  </h3>
                  <p class="text-sm text-gray-600 mb-4">
                    Uploaded by <%= media.uploadedBy.username %> on
                    <%= new Date(media.uploadedAt).toLocaleDateString() %>
                  </p>
                  <div class="flex justify-between items-center text-sm text-gray-500">
                    <span>Uncategorized</span>
                    <% if (media.published) { %>
                      <span class="bg-green-100 text-green-700 px-2 py-1 rounded-lg">
                        Published
                      </span>
                    <% } else { %>
                      <span class="bg-red-100 text-red-700 px-2 py-1 rounded-lg">
                        Unpublished
                      </span>
                    <% } %>
                  </div>
                </div>
              </div>
            <% }) %>
          </div>
        </section>
      <% } %>
    </main>

    <%- include('partials/footer.ejs') %>
  </body>
</html>
